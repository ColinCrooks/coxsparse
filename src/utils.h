// Rcpp::NumericVector makeInt64(std::vector<int64_t> v);
double safelog (double x);
double safesqrt (double x);
// double brent_maximize(double ax, double bx,
//                       double * outcomes_wt, double* group_lambda, int maxid,
//                       double tol = 1e-7, int max_iter = 100);
//   
// 
// double gamma_theta_lkl(double nu, double * outcomes_wt, double* group_lambda, int maxid);

// double profile_loglik_theta(double theta,
//                             const std::map<int, int>& group_event_counts, 
//                             const std::map<int, double>& group_lambda_hat);
// double log_gamma_approx(double x); 
// double digamma_approx(double x);